angular.module("angular-meditor",[]).directive("meditor",["$timeout",function(a){return{scope:{},transclude:!0,templateUrl:"views/editor.html",link:function(b,c){b.position={top:10,left:10,bellow:!1},b.showToolbar=!1,b.sizeOptions=[{label:"10",value:1},{label:"13",value:2},{label:"16",value:3},{label:"18",value:4},{label:"24",value:5},{label:"32",value:6},{label:"48",value:7}],b.size=b.sizeOptions[0].value,b.familyOptions=[{label:"Open Sans",value:"Open Sans, sans-serif"},{label:"Source Sans Pro",value:"Source Sans Pro, sans-serif"},{label:"Exo",value:"Exo, sans-serif"},{label:"Oswald",value:"Oswald, sans-serif"},{label:"Cardo",value:"Cardo, serif"},{label:"Vollkorn",value:"Vollkorn, serif"},{label:"Old Standard TT",value:"Old Standard TT, serif"}],b.family=b.familyOptions[0],b.styles={};var d={b:"",strong:"",i:"",em:"",u:""},e=c.find(".angular-meditor-toolbar"),f=c.find(".angular-meditor-content"),g=c.find("select");f.attr("contenteditable",!0);var h=function(){var a=e[0].offsetHeight,d=e[0].offsetWidth,f=5,g=window.getSelection(),h=g.getRangeAt(0),i=h.getBoundingClientRect(),j=c.get(0).getBoundingClientRect(),k=i.top-j.top,l=i.left-j.left;return i.top<a+f?(b.position.top=k+i.height+f,b.position.bellow=!0):(b.position.top=k-a-f,b.position.bellow=!1),b.position.left=l-d/2+i.width/2,this},i=function(){for(var d=window.getSelection(),e=d.anchorNode.parentNode;void 0!==e.tagName&&e!==c[0];)e=e.parentNode;return e===c[0]?(a(function(){""===d.toString().trim()?b.showToolbar=!1:(b.showToolbar=!0,h())}),j(d)):a(function(){b.showToolbar=!1}),this},j=function(c){var e=c.anchorNode;e.tagName||(e=c.anchorNode.parentNode);var f=e.childNodes[0];f&&f.tagName&&f.tagName.toLowerCase()in d&&(e=e.childNodes[0]),a(function(){b.styles=window.getComputedStyle(e,null),angular.forEach(b.familyOptions,function(a,c){return-1!==b.styles.fontFamily.indexOf(a.label)?(b.family=b.familyOptions[c],!1):void 0}),angular.forEach(b.sizeOptions,function(a,c){return b.styles.fontSize===a.label+"px"?(b.size=b.sizeOptions[c].value,!1):void 0})})},k=!1;f.bind("keyup",i),f.bind("mousedown",function(){k=!0}),document.addEventListener("mouseup",function(a){return k?(k=!1,i(a),void 0):!1},!1);var l;f.bind("blur",function(){l&&clearTimeout(l),l=setTimeout(i,200)});var m;g.bind("blur",function(){m&&clearTimeout(m),m=setTimeout(i,200)}),b.SimpleAction=function(a){document.execCommand("styleWithCSS",!1,!1),document.execCommand(a,!1,null)},b.$watch("size",function(){document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,b.size)}),b.$watch("family",function(){window.WebFont&&WebFont.load({google:{families:[b.family.label]}}),document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontName",!1,b.family.value)}),function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",a.type="text/javascript",a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}()}}}]),angular.module("angular-meditor").run(["$templateCache",function(a){a.put("views/editor.html",'<div class="angular-meditor">\n	<div class="angular-meditor-toolbar" style="top: {{ position.top }}px; left: {{ position.left }}px" ng-class="{ \'angular-meditor-toolbar--show\': showToolbar, \'angular-meditor-toolbar--bottom\': position.bellow }">\n		<ul>\n			<li>\n				<button type="button" ng-click="SimpleAction(\'bold\')" class="meditor-button-bold" ng-class="{ \'bold\': \'meditor-button--active\' }[styles.fontWeight]">\n					B\n				</button>\n			</li>\n			<li>\n				<button type="button" ng-click="SimpleAction(\'italic\')" class="meditor-button-italic" ng-class="{ \'italic\': \'meditor-button--active\' }[styles.fontStyle]">\n					I\n				</button>\n			</li>\n			<li>\n				<button type="button" ng-click="SimpleAction(\'underline\')" class="meditor-button-underline" ng-class="{ \'underline\': \'meditor-button--active\' }[styles.textDecoration]">\n					U\n				</button>\n			</li>\n			<li>\n				<label class="meditor-select">\n					<select ng-model="size" ng-options="s.value as s.label for s in sizeOptions" class="meditor-size-selector"></select>\n				</label>\n			</li>\n			<li>\n				<label class="meditor-select">\n					<select ng-model="family" ng-options="s as s.label for s in familyOptions" class="meditor-family-selector"></select>\n				</label>\n			</li>\n		</ul>\n	</div>\n	<div class="angular-meditor-content" ng-transclude></div>\n</div>\n')}]);